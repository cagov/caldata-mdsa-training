
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../../cloud-data-warehouses/snowflake/">
      
      
        <link rel="next" href="../advanced/macros-custom-tests/">
      
      
      <link rel="icon" href="../../images/odi-circle_logomark-blue.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.15">
    
    
      
        <title>Foundational dbt training - CalData's Modern Data Stack Training</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#dbt-data-build-tool" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="CalData&#39;s Modern Data Stack Training" class="md-header__button md-logo" aria-label="CalData's Modern Data Stack Training" data-md-component="logo">
      
  <img src="../../images/odi-square_logomark-blue.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            CalData's Modern Data Stack Training
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Foundational dbt training
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/cagov/caldata-mdsa-training" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    cagov/caldata-mdsa-training
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="CalData&#39;s Modern Data Stack Training" class="md-nav__button md-logo" aria-label="CalData's Modern Data Stack Training" data-md-component="logo">
      
  <img src="../../images/odi-square_logomark-blue.svg" alt="logo">

    </a>
    CalData's Modern Data Stack Training
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/cagov/caldata-mdsa-training" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    cagov/caldata-mdsa-training
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Code development
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Code development
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../code/git/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    git
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../code/github/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    GitHub
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../code/devops/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Azure DevOps
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../code/local-repo-setup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Local repo setup
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../code/ci-cd/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Continuous Integration/Continuous Deployment
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Cloud data warehouses
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Cloud data warehouses
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud-data-warehouses/snowflake/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Snowflake
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Data transformation
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Data transformation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1" checked>
        
          
          <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Learn dbt
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            Learn dbt
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Foundational dbt training
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Foundational dbt training
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#day-1" class="md-nav__link">
    <span class="md-ellipsis">
      Day 1
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Day 1">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-is-dbt" class="md-nav__link">
    <span class="md-ellipsis">
      What is dbt?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-modeling-in-the-context-of-dbt" class="md-nav__link">
    <span class="md-ellipsis">
      Data modeling in the context of dbt
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-layers-staging-intermediate-marts" class="md-nav__link">
    <span class="md-ellipsis">
      Data layers (staging, intermediate, marts)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#common-table-expressions-ctes" class="md-nav__link">
    <span class="md-ellipsis">
      Common table expressions (CTEs)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#day-1-practice" class="md-nav__link">
    <span class="md-ellipsis">
      Day 1: Practice
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#day-1-references" class="md-nav__link">
    <span class="md-ellipsis">
      Day 1: References
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Day 1: References">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dbt-fundamentals" class="md-nav__link">
    <span class="md-ellipsis">
      dbt Fundamentals
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#models-in-dbt" class="md-nav__link">
    <span class="md-ellipsis">
      Models in dbt
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#day-2" class="md-nav__link">
    <span class="md-ellipsis">
      Day 2
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Day 2">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-are-all-these-yaml-files" class="md-nav__link">
    <span class="md-ellipsis">
      What are all these YAML files?!
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wait-but-what-is-yaml" class="md-nav__link">
    <span class="md-ellipsis">
      Wait, but what is YAML?
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Wait, but what is YAML?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#yaml-dictionariesmaps" class="md-nav__link">
    <span class="md-ellipsis">
      YAML dictionaries/maps
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#yaml-lists" class="md-nav__link">
    <span class="md-ellipsis">
      YAML lists
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#yaml-strings" class="md-nav__link">
    <span class="md-ellipsis">
      YAML strings
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#yaml-multiline-strings" class="md-nav__link">
    <span class="md-ellipsis">
      YAML multiline strings
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#markdown-in-yaml" class="md-nav__link">
    <span class="md-ellipsis">
      Markdown in YAML
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sources-and-refs" class="md-nav__link">
    <span class="md-ellipsis">
      Sources and refs
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Sources and refs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#source" class="md-nav__link">
    <span class="md-ellipsis">
      source()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ref" class="md-nav__link">
    <span class="md-ellipsis">
      ref()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#why-shouldnt-we-directly-refer-to-table-names" class="md-nav__link">
    <span class="md-ellipsis">
      Why shouldn’t we directly refer to table names?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-tests" class="md-nav__link">
    <span class="md-ellipsis">
      Data tests
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#day-2-practice" class="md-nav__link">
    <span class="md-ellipsis">
      Day 2: Practice
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#day-2-references" class="md-nav__link">
    <span class="md-ellipsis">
      Day 2: References
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Day 2: References">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sources" class="md-nav__link">
    <span class="md-ellipsis">
      Sources
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing" class="md-nav__link">
    <span class="md-ellipsis">
      Testing
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#day-3" class="md-nav__link">
    <span class="md-ellipsis">
      Day 3
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Day 3">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cte-examples" class="md-nav__link">
    <span class="md-ellipsis">
      CTE examples
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#materializations" class="md-nav__link">
    <span class="md-ellipsis">
      Materializations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Materializations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#view" class="md-nav__link">
    <span class="md-ellipsis">
      View
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#table" class="md-nav__link">
    <span class="md-ellipsis">
      Table
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#incremental" class="md-nav__link">
    <span class="md-ellipsis">
      Incremental
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a-comparison-table" class="md-nav__link">
    <span class="md-ellipsis">
      A comparison table
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#materializations-golden-rule" class="md-nav__link">
    <span class="md-ellipsis">
      Materializations golden rule
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ephemeral" class="md-nav__link">
    <span class="md-ellipsis">
      Ephemeral
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#where-to-configure-materializations" class="md-nav__link">
    <span class="md-ellipsis">
      Where to configure materializations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#day-3-practice" class="md-nav__link">
    <span class="md-ellipsis">
      Day 3: Practice
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#day-3-references" class="md-nav__link">
    <span class="md-ellipsis">
      Day 3: References
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Day 3: References">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#materializations-jinja-and-dbt-models" class="md-nav__link">
    <span class="md-ellipsis">
      Materializations, Jinja, and dbt Models
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#day-4" class="md-nav__link">
    <span class="md-ellipsis">
      Day 4
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Day 4">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dbt-docs" class="md-nav__link">
    <span class="md-ellipsis">
      dbt Docs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-environments-and-jobs" class="md-nav__link">
    <span class="md-ellipsis">
      Data environments and jobs
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Data environments and jobs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#environments-in-snowflake" class="md-nav__link">
    <span class="md-ellipsis">
      Environments in Snowflake
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#environments-in-dbt-cloud" class="md-nav__link">
    <span class="md-ellipsis">
      Environments in dbt Cloud
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jobs" class="md-nav__link">
    <span class="md-ellipsis">
      Jobs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#continuous-integration-and-continuous-deployment-cicd" class="md-nav__link">
    <span class="md-ellipsis">
      Continuous integration and continuous deployment (CI/CD)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Continuous integration and continuous deployment (CI/CD)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-continuous-integration-ci-is-and-why-you-shouldnt-ignore-it" class="md-nav__link">
    <span class="md-ellipsis">
      What Continuous Integration (CI) is, and why you shouldn’t ignore it
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#continuous-deployment-cd" class="md-nav__link">
    <span class="md-ellipsis">
      Continuous Deployment (CD)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#demo-cicd-in-a-development-workflow" class="md-nav__link">
    <span class="md-ellipsis">
      Demo: CI/CD in a development workflow
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#custom-schema-names" class="md-nav__link">
    <span class="md-ellipsis">
      Custom schema names
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#day-4-practice" class="md-nav__link">
    <span class="md-ellipsis">
      Day 4: Practice
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#day-4-references" class="md-nav__link">
    <span class="md-ellipsis">
      Day 4: References
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Day 4: References">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#documentation" class="md-nav__link">
    <span class="md-ellipsis">
      Documentation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_2" >
        
          
          <label class="md-nav__link" for="__nav_4_1_2" id="__nav_4_1_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Advanced dbt training
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_2">
            <span class="md-nav__icon md-icon"></span>
            Advanced dbt training
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../advanced/macros-custom-tests/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Macros and custom tests in dbt
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Practice dbt
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            Practice dbt
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dbt-cloud-practice/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    dbt Cloud practice
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dbt-core-practice/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    dbt Core practice
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dbt-practice-answers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Answer key
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#day-1" class="md-nav__link">
    <span class="md-ellipsis">
      Day 1
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Day 1">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-is-dbt" class="md-nav__link">
    <span class="md-ellipsis">
      What is dbt?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-modeling-in-the-context-of-dbt" class="md-nav__link">
    <span class="md-ellipsis">
      Data modeling in the context of dbt
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-layers-staging-intermediate-marts" class="md-nav__link">
    <span class="md-ellipsis">
      Data layers (staging, intermediate, marts)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#common-table-expressions-ctes" class="md-nav__link">
    <span class="md-ellipsis">
      Common table expressions (CTEs)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#day-1-practice" class="md-nav__link">
    <span class="md-ellipsis">
      Day 1: Practice
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#day-1-references" class="md-nav__link">
    <span class="md-ellipsis">
      Day 1: References
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Day 1: References">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dbt-fundamentals" class="md-nav__link">
    <span class="md-ellipsis">
      dbt Fundamentals
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#models-in-dbt" class="md-nav__link">
    <span class="md-ellipsis">
      Models in dbt
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#day-2" class="md-nav__link">
    <span class="md-ellipsis">
      Day 2
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Day 2">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-are-all-these-yaml-files" class="md-nav__link">
    <span class="md-ellipsis">
      What are all these YAML files?!
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wait-but-what-is-yaml" class="md-nav__link">
    <span class="md-ellipsis">
      Wait, but what is YAML?
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Wait, but what is YAML?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#yaml-dictionariesmaps" class="md-nav__link">
    <span class="md-ellipsis">
      YAML dictionaries/maps
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#yaml-lists" class="md-nav__link">
    <span class="md-ellipsis">
      YAML lists
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#yaml-strings" class="md-nav__link">
    <span class="md-ellipsis">
      YAML strings
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#yaml-multiline-strings" class="md-nav__link">
    <span class="md-ellipsis">
      YAML multiline strings
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#markdown-in-yaml" class="md-nav__link">
    <span class="md-ellipsis">
      Markdown in YAML
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sources-and-refs" class="md-nav__link">
    <span class="md-ellipsis">
      Sources and refs
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Sources and refs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#source" class="md-nav__link">
    <span class="md-ellipsis">
      source()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ref" class="md-nav__link">
    <span class="md-ellipsis">
      ref()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#why-shouldnt-we-directly-refer-to-table-names" class="md-nav__link">
    <span class="md-ellipsis">
      Why shouldn’t we directly refer to table names?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-tests" class="md-nav__link">
    <span class="md-ellipsis">
      Data tests
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#day-2-practice" class="md-nav__link">
    <span class="md-ellipsis">
      Day 2: Practice
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#day-2-references" class="md-nav__link">
    <span class="md-ellipsis">
      Day 2: References
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Day 2: References">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sources" class="md-nav__link">
    <span class="md-ellipsis">
      Sources
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing" class="md-nav__link">
    <span class="md-ellipsis">
      Testing
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#day-3" class="md-nav__link">
    <span class="md-ellipsis">
      Day 3
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Day 3">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cte-examples" class="md-nav__link">
    <span class="md-ellipsis">
      CTE examples
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#materializations" class="md-nav__link">
    <span class="md-ellipsis">
      Materializations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Materializations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#view" class="md-nav__link">
    <span class="md-ellipsis">
      View
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#table" class="md-nav__link">
    <span class="md-ellipsis">
      Table
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#incremental" class="md-nav__link">
    <span class="md-ellipsis">
      Incremental
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a-comparison-table" class="md-nav__link">
    <span class="md-ellipsis">
      A comparison table
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#materializations-golden-rule" class="md-nav__link">
    <span class="md-ellipsis">
      Materializations golden rule
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ephemeral" class="md-nav__link">
    <span class="md-ellipsis">
      Ephemeral
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#where-to-configure-materializations" class="md-nav__link">
    <span class="md-ellipsis">
      Where to configure materializations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#day-3-practice" class="md-nav__link">
    <span class="md-ellipsis">
      Day 3: Practice
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#day-3-references" class="md-nav__link">
    <span class="md-ellipsis">
      Day 3: References
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Day 3: References">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#materializations-jinja-and-dbt-models" class="md-nav__link">
    <span class="md-ellipsis">
      Materializations, Jinja, and dbt Models
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#day-4" class="md-nav__link">
    <span class="md-ellipsis">
      Day 4
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Day 4">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dbt-docs" class="md-nav__link">
    <span class="md-ellipsis">
      dbt Docs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-environments-and-jobs" class="md-nav__link">
    <span class="md-ellipsis">
      Data environments and jobs
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Data environments and jobs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#environments-in-snowflake" class="md-nav__link">
    <span class="md-ellipsis">
      Environments in Snowflake
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#environments-in-dbt-cloud" class="md-nav__link">
    <span class="md-ellipsis">
      Environments in dbt Cloud
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jobs" class="md-nav__link">
    <span class="md-ellipsis">
      Jobs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#continuous-integration-and-continuous-deployment-cicd" class="md-nav__link">
    <span class="md-ellipsis">
      Continuous integration and continuous deployment (CI/CD)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Continuous integration and continuous deployment (CI/CD)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-continuous-integration-ci-is-and-why-you-shouldnt-ignore-it" class="md-nav__link">
    <span class="md-ellipsis">
      What Continuous Integration (CI) is, and why you shouldn’t ignore it
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#continuous-deployment-cd" class="md-nav__link">
    <span class="md-ellipsis">
      Continuous Deployment (CD)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#demo-cicd-in-a-development-workflow" class="md-nav__link">
    <span class="md-ellipsis">
      Demo: CI/CD in a development workflow
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#custom-schema-names" class="md-nav__link">
    <span class="md-ellipsis">
      Custom schema names
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#day-4-practice" class="md-nav__link">
    <span class="md-ellipsis">
      Day 4: Practice
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#day-4-references" class="md-nav__link">
    <span class="md-ellipsis">
      Day 4: References
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Day 4: References">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#documentation" class="md-nav__link">
    <span class="md-ellipsis">
      Documentation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="dbt-data-build-tool">dbt (data build tool)<a class="headerlink" href="#dbt-data-build-tool" title="Permanent link">&para;</a></h1>
<h2 id="day-1">Day 1<a class="headerlink" href="#day-1" title="Permanent link">&para;</a></h2>
<h3 id="what-is-dbt">What is dbt?<a class="headerlink" href="#what-is-dbt" title="Permanent link">&para;</a></h3>
<p>dbt is a SQL-first transformation tool that lets teams quickly and collaboratively deploy analytics code while following software engineering best practices like modularity, version control, CI/CD, and documentation. This allows your data team to safely develop and contribute to production-grade data pipelines.</p>
<h3 id="data-modeling-in-the-context-of-dbt">Data modeling in the context of dbt<a class="headerlink" href="#data-modeling-in-the-context-of-dbt" title="Permanent link">&para;</a></h3>
<p>In the context of dbt, data modeling refers to the process of organizing data in a structured and efficient manner to facilitate data analysis and decision-making. Data models in dbt serve as blueprints for transforming and organizing your raw data into valuable insights. Data models in their final form are usually a representation of a business or program area and live as tables or views in your data warehouse.</p>
<h3 id="data-layers-staging-intermediate-marts">Data layers (staging, intermediate, marts)<a class="headerlink" href="#data-layers-staging-intermediate-marts" title="Permanent link">&para;</a></h3>
<p>Data layers represent a systematic approach to data modeling by organizing data into distinct phases. dbt does a particularly great job of explaining best practices to structuring your project and data with naming conventions, example code, and reasoning on such practices in <a href="https://docs.getdbt.com/best-practices/how-we-structure/1-guide-overview">this guide</a>. We’ve summarized it below, but still recommend a thorough read of dbt’s guide from which the content below stems.</p>
<ol>
<li><strong>Staging</strong><ol>
<li>The staging layer is the initial point of contact for your raw data</li>
<li>Models in the staging layer have a one-to-one relationship with source data ensuring data integrity and providing a reliable foundation for downstream models</li>
<li>There are very few transformations that happen in this layer. Appropriate ones are:<ol>
<li>Column renaming (e.g. PLACEFP to place_fips)</li>
<li>Data type casting (e.g. string type to numeric)</li>
<li>Basic computations (e.g. cents to dollars)</li>
</ol>
</li>
<li>Staging models are often materialized ephemerally or as views (more about materializations later!)</li>
<li>Files are prefixed with <code>stg_</code> and saved in a subdirectory usually named “staging” of the models folder</li>
</ol>
</li>
<li><strong>Intermediate</strong><ol>
<li>Intermediate models are where you start applying more complex transformations to your data</li>
<li>This layer is used for data cleansing, feature engineering, and combining data from different sources</li>
<li>Intermediate models allow you to build modular and reusable transformations following the principles of <a href="https://docs.getdbt.com/terms/dry#why-write-dry-code">DRY (Don’t Repeat Yourself)</a></li>
<li>Common transformations that happen in this layer are:<ol>
<li>Table joins or unions</li>
<li>Data aggregations (e.g. using a function like <code>SUM()</code>)</li>
<li>Data pivots</li>
</ol>
</li>
<li>Files are prefixed with <code>int_</code> and saved in a subdirectory usually named “intermediate” of the models folder</li>
</ol>
</li>
<li><strong>Marts (or Data Marts)</strong><ol>
<li>Marts are the final layer in the data modeling process, representing consumable datasets tailored for specific business or programs needs</li>
<li>Sometimes called the entity layer or concept layer, to emphasize that our marts are meant to represent a specific entity or concept at its unique grain</li>
<li>Use plain English to name the file based on the concept that forms the grain of the mart e.g. <code>incidents.sql</code>, <code>claimants.sql</code>, <code>orders.sql</code></li>
<li>Wide and denormalized</li>
<li>Files are saved in a subdirectory usually named "marts" of the models folder</li>
</ol>
</li>
</ol>
<h3 id="common-table-expressions-ctes">Common table expressions (CTEs)<a class="headerlink" href="#common-table-expressions-ctes" title="Permanent link">&para;</a></h3>
<p>CTEs are widely used as a way to create modular and readable SQL queries. You can think of CTEs as temporary, named data tables within your SQL queries. CTEs facilitate modularity and readability by encapsulating complex subqueries and making them reusable throughout your data models.</p>
<p>Often CTEs are framed as an alternative to SQL subqueries. In dbt-style SQL, CTEs are usually preferable to subqueries for a few reasons:</p>
<ol>
<li>They allow you to read code from top to bottom rather than inside out</li>
<li>They allow for better reuse of intermediate results</li>
<li>They allow you to give descriptive names to intermediate results</li>
</ol>
<table>
  <thead>
    <tr>
      <th>Subquery</th>
      <th>CTE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        <pre>
          <code>
select *
from (
    select
        COUNTY_NAME,
        SUM(SAMPLE_COUNT) as total_samples
    from raw_dev.water_quality.stations
    group by "COUNTY_NAME"
) as subquery
where total_samples > 10
          </code>
        </pre>
      </td>
      <td>
        <pre>
          <code>
with total_samples_by_county as (
    select
        "COUNTY_NAME",
        SUM(SAMPLE_COUNT) as total_samples
    from raw_dev.water_quality.stations
    group by "COUNTY_NAME"
)
select * from total_samples_by_county
where total_samples > 10
          </code>
        </pre>
      </td>
    </tr>
  </tbody>
</table>

<h3 id="day-1-practice">Day 1: Practice<a class="headerlink" href="#day-1-practice" title="Permanent link">&para;</a></h3>
<p>Click either link for <a href="https://cagov.github.io/caldata-mdsa-training/data-transformation/dbt-cloud-practice/#day-1"><u>dbt Cloud</u></a> or <a href="https://cagov.github.io/caldata-mdsa-training/data-transformation/dbt-core-practice/#day-1"><u>dbt Core</u></a> practice.</p>
<h3 id="day-1-references">Day 1: References<a class="headerlink" href="#day-1-references" title="Permanent link">&para;</a></h3>
<h4 id="dbt-fundamentals">dbt Fundamentals<a class="headerlink" href="#dbt-fundamentals" title="Permanent link">&para;</a></h4>
<p><a href="https://courses.getdbt.com/courses/fundamentals">dbt Fundamentals</a> is an online self-paced course on how to use dbt and dbt Cloud. It is broadly similar to the content in this training, and you may find some of the videos from the course helpful to review. We’ve linked to some of the videos below.</p>
<h4 id="models-in-dbt">Models in dbt<a class="headerlink" href="#models-in-dbt" title="Permanent link">&para;</a></h4>
<ul>
<li><a href="https://platform.thinkific.com/videoproxy/v1/play/c71iuqg02svskgqkn6jg">What are models?</a></li>
<li><a href="https://platform.thinkific.com/videoproxy/v1/play/cecuppiekd0onghk4p20">Building your first model</a></li>
<li><a href="https://platform.thinkific.com/videoproxy/v1/play/c71iuqg02svskgqkn6lg">What is modularity?</a></li>
</ul>
<h2 id="day-2">Day 2<a class="headerlink" href="#day-2" title="Permanent link">&para;</a></h2>
<h3 id="what-are-all-these-yaml-files">What are all these YAML files?!<a class="headerlink" href="#what-are-all-these-yaml-files" title="Permanent link">&para;</a></h3>
<p>Broadly speaking, there are two kinds of relations (a relation is a table or view) in a dbt project: “models” and “sources”. “Sources” are your raw, untransformed data sets. “Models” are the tables and views that you create when transforming your data into something. Both of these are described using YAML files.</p>
<p>The YAML files in a dbt project contain the metadata for your relations, both sources and models. They include:</p>
<ul>
<li>Documentation</li>
<li>Configuration</li>
<li>Data tests</li>
</ul>
<h3 id="wait-but-what-is-yaml">Wait, but what <em>is</em> YAML?<a class="headerlink" href="#wait-but-what-is-yaml" title="Permanent link">&para;</a></h3>
<p>YAML stands for “Yet Another Markup Language”. It is a superset of JSON (JavaScript Object Notation) and intended to be a more human readable version, but JSON is still perfectly valid! For example, <code>{“my-key”: 4}</code> is YAML. YAML has support for:</p>
<ul>
<li>Key-value pairs (i.e., dictionaries/maps)</li>
<li>Lists</li>
<li>Strings, numbers, booleans</li>
</ul>
<p>It is also absolutely ubiquitous for tool configuration. Tools that are configured using YAML include:</p>
<ul>
<li>dbt</li>
<li>GitHub Actions</li>
<li>Azure Pipelines</li>
<li>BitBucket Pipelines</li>
<li>Kubernetes</li>
<li>AWS CloudFormation</li>
<li>Many more!</li>
</ul>
<p>Indentation is meaningful in YAML. Make sure that you use <strong>2 spaces</strong>, rather than tab characters, to indent sections per level of nesting.</p>
<h4 id="yaml-dictionariesmaps">YAML dictionaries/maps<a class="headerlink" href="#yaml-dictionariesmaps" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1"># In YAML, comments are started with the hashtag # symbol</span>

<span class="c1"># Dictionaries/maps are constructed using indentation and the colon &quot;:&quot; symbol</span>
<span class="nt">my_dictionary</span><span class="p">:</span>
<span class="w">  </span><span class="nt">a_number</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">12</span>
<span class="w">  </span><span class="nt">a_string</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;hello,</span><span class="nv"> </span><span class="s">world!&quot;</span>
<span class="w">  </span><span class="nt">a_boolean</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">a_nested_dictionary</span><span class="p">:</span>
<span class="w">    </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;value&quot;</span>
<span class="w">    </span><span class="nt">another_key</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;another</span><span class="nv"> </span><span class="s">value&quot;</span>

<span class="c1"># Because YAML is a superset of JSON, we can equivalently write:</span>
<span class="nt">my_dictionary</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&quot;a_number&quot;</span><span class="p p-Indicator">:</span><span class="nv">12</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;a_string&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;hello,</span><span class="nv"> </span><span class="s">world!&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;a_boolean&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">true</span><span class="p p-Indicator">}</span>
</code></pre></div>
<h4 id="yaml-lists">YAML lists<a class="headerlink" href="#yaml-lists" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1"># Lists are constructed using the dash - symbol</span>
<span class="nt">my_list</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">4</span>

<span class="c1"># Because YAML is a superset of JSON, we can equivalently write:</span>
<span class="nt">my_list</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">2</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">3</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">4</span><span class="p p-Indicator">]</span>
</code></pre></div>
<h4 id="yaml-strings">YAML strings<a class="headerlink" href="#yaml-strings" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1"># YAML strings may be written without quotes &quot;&quot; as long as there is no ambiguity</span>
<span class="nt">my_ionary</span><span class="p">:</span>
<span class="w">  </span><span class="nt">a_string</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;britt</span><span class="nv"> </span><span class="s">is</span><span class="nv"> </span><span class="s">cool!&quot;</span>
<span class="w">  </span><span class="nt">also_a_string</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">britt is cool</span>

<span class="c1"># But omitting the quotes for a string can get you in trouble when the string is ambiguous!</span>
<span class="nt">my_dictionary</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># This is interpreted as a number (which is not what we want)</span>
<span class="w">  </span><span class="nt">python_version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3.9</span>

<span class="w">  </span><span class="c1"># This would pull in python 3.1 instead of 3.10!</span>
<span class="w">  </span><span class="nt">another_python_version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3.10</span>

<span class="w">  </span><span class="c1"># This gets interpreted as a boolean instead of a string!</span>
<span class="w">  </span><span class="nt">should_i_eat_lunch</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yes</span>
</code></pre></div>
<h4 id="yaml-multiline-strings">YAML multiline strings<a class="headerlink" href="#yaml-multiline-strings" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1"># Use the pipe | or right angle bracket &gt; symbol to break up long strings for legibility</span>
<span class="nt">long_snippet</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">  </span><span class="no">cotton candy blues</span>
<span class="w">  </span><span class="no">juxtaposed with blushing peaks</span>
<span class="w">  </span><span class="no">postcard-worthy views</span>

<span class="nt">another_long_snippet</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">&gt;</span>
<span class="w">  </span><span class="no">Call me Ishmael. Some years ago - never mind how long precisely -</span>
<span class="w">  </span><span class="no">having little or no money in my purse, and nothing particular to</span>
<span class="w">  </span><span class="no">interest me on shore, I thought I would sail about a little and see</span>
<span class="w">  </span><span class="no">the watery part of the world.</span>
</code></pre></div>
<h4 id="markdown-in-yaml">Markdown in YAML<a class="headerlink" href="#markdown-in-yaml" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1"># dbt renders description strings as Markdown</span>
<span class="nt">a_markdown_string</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">  </span><span class="no">This is rendered as Markdown! So I can use _emphasis_</span>
<span class="w">  </span><span class="no">or **bold text**. I can also include:</span>

<span class="w">  </span><span class="no">- Lists</span>
<span class="w">  </span><span class="no">- of</span>
<span class="w">  </span><span class="no">- items</span>

<span class="w">  </span><span class="no">as well as [URLs](https://github.github.com/gfm/)</span>
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Code blocks are designed to display text literally, so Markdown formatting like bolding, italicizing, or headings won't be applied. Hence why you do not see the affect above. However, in dbt which does allow
for richer text formatting, applying markdown to your YAML, like we've done above, will work.</p>
</div>
<h3 id="sources-and-refs">Sources and refs<a class="headerlink" href="#sources-and-refs" title="Permanent link">&para;</a></h3>
<p>Let’s take a look at the <code>source</code> and <code>ref</code> dbt macros. Instead of directly referring to the database, schema, table, and view names, we use the <code>source</code> and <code>ref</code> dbt macros. The syntax for this is to replace the raw names with a template directive like this: <code>{{ source('WATER_QUALITY', 'STATIONS') }}</code>.</p>
<p>The curly braces are a syntax for <em>Jinja</em> templating. The expression within the curly braces is a Python (ish) function which gets evaluated and inserted into the SQL file. There are lots of things we can do with Jinja to help generate our SQL queries, including basic math, custom Python functions, loops, and if-else statements. Most of the time, you will just need to be able to use the <code>source</code> and <code>ref</code> macros.</p>
<h4 id="source">source()<a class="headerlink" href="#source" title="Permanent link">&para;</a></h4>
<p>This function creates dependencies between source data and the current model (usually staging) referencing it. Your dbt project will depend on raw data stored in your database. Since this data is normally loaded by other tools than dbt, the structure of it can change over time – tables and columns may be added, removed, or renamed. When this happens, it is easier to update models if raw data is only referenced in one place.</p>
<p><strong>Example:</strong> replace <code>RAW_DEV.WATER_QUALITY.LAB_RESULTS</code> with <code>{{ source('WATER_QUALITY', 'LAB_RESULTS') }}</code>.</p>
<h4 id="ref">ref()<a class="headerlink" href="#ref" title="Permanent link">&para;</a></h4>
<p>This function is how you reference a model from another: it allows you to build more complex models by referring to other ones and constructing a data lineage graph. Under the hood this function is actually doing two important things. First, it is interpolating the schema into your model file to allow you to change your deployment schema via configuration. Second, it is using these references between models to automatically build the dependency graph. This will enable dbt to deploy models in the correct order when using dbt run.</p>
<p><strong>Example:</strong> Replace <code>stg_water_quality__stations</code> with <code>{{ ref(‘stg_water_quality__stations’) }}</code>.</p>
<h4 id="why-shouldnt-we-directly-refer-to-table-names">Why shouldn’t we directly refer to table names?<a class="headerlink" href="#why-shouldnt-we-directly-refer-to-table-names" title="Permanent link">&para;</a></h4>
<p>It can be initially confusing to people that we don’t directly refer to the names of the other data models, and instead do it indirectly via the <code>source</code> and <code>ref</code> macros. There are a few reasons for this:</p>
<ol>
<li>By explicitly linking your sources and models using the <code>source</code> and <code>ref</code> macros, you help dbt in constructing a data lineage graph (i.e., which tables depend on which others). This allows you to do things like “rebuild a model and all of its upstream dependencies”, or “test a model and all of its downstream dependents”.</li>
<li>It becomes easier to rename a data source. This can be especially useful if the data source comes to you with unhelpful names.</li>
<li>Source and refs become context aware. For example, in a development context, your personal development schema is templated into the SQL queries, but in a production context the final production schema is templated in. This allows for safer development of new models.</li>
</ol>
<h3 id="data-tests">Data tests<a class="headerlink" href="#data-tests" title="Permanent link">&para;</a></h3>
<p>dbt ships with 4 “generic” data tests. We recommend giving their <a href="https://docs.getdbt.com/docs/build/data-tests">data test documentation</a> a thorough read as we only pulled high-level content from it.:</p>
<ol>
<li>Not null</li>
<li>Unique</li>
<li>Relationships</li>
<li>Accepted Values</li>
</ol>
<p>Default test outcomes are:</p>
<ul>
<li>Pass: 0 rows found</li>
<li>Fail: 1+ rows found</li>
</ul>
<p>dbt example:</p>
<div class="highlight"><pre><span></span><code><span class="nt">models</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">orders</span>
<span class="w">    </span><span class="nt">columns</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">order_id</span>
<span class="w">        </span><span class="nt">data_tests</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unique</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not_null</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">status</span>
<span class="w">        </span><span class="nt">data_tests</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">accepted_values</span><span class="p">:</span>
<span class="w">              </span><span class="nt">values</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;placed&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;shipped&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;completed&#39;</span><span class="p p-Indicator">]</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">customer_id</span>
<span class="w">        </span><span class="nt">data_tests</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">relationships</span><span class="p">:</span>
<span class="w">              </span><span class="nt">to</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ref(&#39;customers&#39;)</span>
<span class="w">    </span><span class="nt">data_tests</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">unique</span><span class="p">:</span>
<span class="w">          </span><span class="nt">column_name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;(customer_id</span><span class="nv"> </span><span class="s">||</span><span class="nv"> </span><span class="s">&#39;-&#39;</span><span class="nv"> </span><span class="s">||</span><span class="nv"> </span><span class="s">order_date)&quot;</span>
</code></pre></div>
<p>In dbt you execute tests with either of the following:</p>
<ul>
<li>dbt test (tests models only)</li>
<li>dbt build (builds and tests models)</li>
</ul>
<p>Sample results from the YAML config above</p>
<div class="highlight"><pre><span></span><code><span class="m">23</span><span class="o">:</span><span class="m">52</span><span class="o">:</span><span class="m">21</span><span class="w">  </span><span class="m">1</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="n">START</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="n">unique_orders__order_id_</span><span class="w"> </span><span class="n">...........</span><span class="w"> </span><span class="p">[</span><span class="n">RUN</span><span class="p">]</span>
<span class="m">23</span><span class="o">:</span><span class="m">52</span><span class="o">:</span><span class="m">21</span><span class="w">  </span><span class="m">2</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="n">START</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="n">not_null_orders__order_id_</span><span class="w"> </span><span class="n">.........</span><span class="w"> </span><span class="p">[</span><span class="n">RUN</span><span class="p">]</span>
<span class="m">23</span><span class="o">:</span><span class="m">52</span><span class="o">:</span><span class="m">21</span><span class="w">  </span><span class="m">3</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="n">START</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="n">accepted_values_orders__status_</span><span class="w"> </span><span class="n">....</span><span class="w"> </span><span class="p">[</span><span class="n">RUN</span><span class="p">]</span>
<span class="m">23</span><span class="o">:</span><span class="m">52</span><span class="o">:</span><span class="m">21</span><span class="w">  </span><span class="m">1</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="n">PASS</span><span class="w"> </span><span class="n">unique_orders__order_id_</span><span class="w"> </span><span class="n">.................</span><span class="w"> </span><span class="p">[</span><span class="n">PASS</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="m">0.69</span><span class="n">s</span><span class="p">]</span>
<span class="m">23</span><span class="o">:</span><span class="m">52</span><span class="o">:</span><span class="m">21</span><span class="w">  </span><span class="m">4</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="n">START</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="n">relationships_orders__customer_id_</span><span class="w"> </span><span class="n">.</span><span class="w"> </span><span class="p">[</span><span class="n">RUN</span><span class="p">]</span>
<span class="m">23</span><span class="o">:</span><span class="m">52</span><span class="o">:</span><span class="m">22</span><span class="w">  </span><span class="m">2</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="n">PASS</span><span class="w"> </span><span class="n">not_null_orders__order_id_</span><span class="w"> </span><span class="n">...............</span><span class="w"> </span><span class="p">[</span><span class="n">PASS</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="m">0.78</span><span class="n">s</span><span class="p">]</span>
<span class="m">23</span><span class="o">:</span><span class="m">52</span><span class="o">:</span><span class="m">22</span><span class="w">  </span><span class="m">3</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="n">PASS</span><span class="w"> </span><span class="n">accepted_values_orders__status_</span><span class="w"> </span><span class="n">..........</span><span class="w"> </span><span class="p">[</span><span class="n">PASS</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="m">0.74</span><span class="n">s</span><span class="p">]</span>
<span class="m">23</span><span class="o">:</span><span class="m">52</span><span class="o">:</span><span class="m">22</span><span class="w">  </span><span class="m">4</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="n">PASS</span><span class="w"> </span><span class="n">relationships_orders__customer_id_</span><span class="w"> </span><span class="n">.......</span><span class="w"> </span><span class="p">[</span><span class="n">PASS</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="m">0.57</span><span class="n">s</span><span class="p">]</span>
<span class="m">23</span><span class="o">:</span><span class="m">52</span><span class="o">:</span><span class="m">22</span>
<span class="m">23</span><span class="o">:</span><span class="m">52</span><span class="o">:</span><span class="m">22</span><span class="w">  </span><span class="n">Finished</span><span class="w"> </span><span class="n">running</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="n">tests</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="n">hours</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="n">minutes</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="m">2.81</span><span class="w"> </span><span class="nf">seconds </span><span class="p">(</span><span class="m">2.81</span><span class="n">s</span><span class="p">)</span><span class="n">.</span>
<span class="m">23</span><span class="o">:</span><span class="m">52</span><span class="o">:</span><span class="m">22</span>
<span class="m">23</span><span class="o">:</span><span class="m">52</span><span class="o">:</span><span class="m">22</span><span class="w">  </span><span class="n">Completed</span><span class="w"> </span><span class="n">successfully</span>
<span class="m">23</span><span class="o">:</span><span class="m">52</span><span class="o">:</span><span class="m">22</span>
<span class="m">23</span><span class="o">:</span><span class="m">52</span><span class="o">:</span><span class="m">22</span><span class="w">  </span><span class="n">Done.</span><span class="w"> </span><span class="n">PASS</span><span class="o">=</span><span class="m">4</span><span class="w"> </span><span class="n">WARN</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="n">ERROR</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="n">SKIP</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="n">TOTAL</span><span class="o">=</span><span class="m">4</span>
</code></pre></div>
<p><a href="https://docs.getdbt.com/reference/resource-configs/severity">Test severity</a> can be configured like so:</p>
<ul>
<li>error: test will pass or fail (default)</li>
<li>warn: test will pass or warn</li>
</ul>
<p>Tests with a severity of “error” can also have warnings configured.</p>
<p>dbt example:</p>
<div class="highlight"><pre><span></span><code><span class="nt">columns</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">controller_id</span>
<span class="w">    </span><span class="nt">data_tests</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not_null</span>

<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">controller_type</span>
<span class="w">    </span><span class="nt">data_tests</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">not_null</span><span class="p">:</span>
<span class="w">          </span><span class="nt">config</span><span class="p">:</span>
<span class="w">            </span><span class="nt">severity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">warn</span>
</code></pre></div>
<p>Thresholds can be configured with <em>error_if</em> and <em>warn_if</em> options. The default is <em>error_if</em>:  <code>&gt; 0</code>
When working with Snowflake you can use any supported comparison syntax like so: <code>= 0</code>, <code>&lt;&gt; 15</code>, or <code>between 10 and 20</code>.
Also, note that <em>error_if</em> will be ignored if severity is warn!</p>
<p>dbt example:</p>
<div class="highlight"><pre><span></span><code><span class="nt">columns</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">controller_id</span>
<span class="w">    </span><span class="nt">data_tests</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not_null</span>

<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">controller_type</span>
<span class="w">    </span><span class="nt">data_tests</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">not_null</span><span class="p">:</span>
<span class="w">          </span><span class="nt">config</span><span class="p">:</span>
<span class="w">            </span><span class="nt">severity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">warn</span>

<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">district</span>
<span class="w">    </span><span class="nt">data_tests</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">not_null</span><span class="p">:</span>
<span class="w">          </span><span class="nt">config</span><span class="p">:</span>
<span class="w">            </span><span class="nt">error_if</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&gt;10&quot;</span>
<span class="w">            </span><span class="nt">warn_if</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&gt;5&quot;</span>
</code></pre></div>
<p>For people who are familiar with transactional databases, you might be curious why tests like this are ever
needed (i.e., why don’t we handle it using constraints?). In a traditional transactional database like
postgres or SQL Server, you can have a uniqueness constraint on a column. Snowflake does not respect
uniqueness constraints and most OLAP databases do not either. Primary keys and foreign keys are examples of
unique columns that are respected in OLTP databases that are not in OLAP databases. If you're interested the
is <a href="https://cagov.github.io/data-infrastructure/learning/cloud-data-warehouses/#primary-keys-and-constraints">more reading</a> available on this topic.</p>
<h3 id="day-2-practice">Day 2: Practice<a class="headerlink" href="#day-2-practice" title="Permanent link">&para;</a></h3>
<p>Click either link for <a href="https://cagov.github.io/caldata-mdsa-training/data-transformation/dbt-cloud-practice/#day-2"><u>dbt Cloud</u></a> or <a href="https://cagov.github.io/caldata-mdsa-training/data-transformation/dbt-core-practice/#day-2"><u>dbt Core</u></a> practice.</p>
<h3 id="day-2-references">Day 2: References<a class="headerlink" href="#day-2-references" title="Permanent link">&para;</a></h3>
<h4 id="sources">Sources<a class="headerlink" href="#sources" title="Permanent link">&para;</a></h4>
<ul>
<li><a href="https://platform.thinkific.com/videoproxy/v1/play/cefo4lqgv9ite187s6pg">Modularity and ref functions</a></li>
<li><a href="https://platform.thinkific.com/videoproxy/v1/play/c6mfkh840bhpn3t0c730">What are sources?</a></li>
<li><a href="https://platform.thinkific.com/videoproxy/v1/play/ce4cj9s69iu53jbdif6g">Configure and select from sources</a></li>
<li><a href="https://platform.thinkific.com/videoproxy/v1/play/ce2dbtnf17fhkgqdq580">Documenting sources</a></li>
</ul>
<h4 id="testing">Testing<a class="headerlink" href="#testing" title="Permanent link">&para;</a></h4>
<ul>
<li><a href="https://platform.thinkific.com/videoproxy/v1/play/c71iuqg40bhpn3t11pcg">What is testing?</a></li>
<li><a href="https://platform.thinkific.com/videoproxy/v1/play/ce9kjv0r715nknv53nhg">Generic tests</a></li>
</ul>
<h2 id="day-3">Day 3<a class="headerlink" href="#day-3" title="Permanent link">&para;</a></h2>
<p>Let refresh our memory on <a href="https://cagov.github.io/caldata-mdsa-training/data-transformation/dbt/#data-layers-staging-intermediate-marts">data layers for intermediate models</a>. Let's also revisit <a href="https://cagov.github.io/caldata-mdsa-training/data-transformation/dbt/#common-table-expressions-ctes">common table expressions (CTEs)</a></p>
<h3 id="cte-examples">CTE examples<a class="headerlink" href="#cte-examples" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1">-- Let&#39;s go from writing our code like this...</span>

<span class="k">select</span>
<span class="w">    </span><span class="ss">&quot;station_id&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;latitude&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;longitude&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;county_name&quot;</span>

<span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="k">source</span><span class="p">(</span><span class="s1">&#39;WATER_QUALITY&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;lab_results&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>

<span class="c1">-- To writing our code like this</span>

<span class="k">with</span><span class="w"> </span><span class="k">source</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="k">source</span><span class="p">(</span><span class="s1">&#39;WATER_QUALITY&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;lab_results&#39;</span><span class="p">)</span><span class="w"> </span><span class="err">}}</span>
<span class="p">),</span>

<span class="n">lab_results</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>
<span class="w">  </span><span class="k">select</span>
<span class="w">    </span><span class="ss">&quot;station_id&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;latitude&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;longitude&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;county_name&quot;</span>

<span class="w">  </span><span class="k">from</span><span class="w"> </span><span class="k">source</span>
<span class="p">)</span>

<span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">lab_results</span>
</code></pre></div>
<p>Here’s <a href="https://github.com/cagov/data-infrastructure/blob/main/transform/models/marts/geo_reference/geo_reference__global_ml_building_footprints_with_tiger.sql">another example of a more complex, multi-stage CTE</a> query.</p>
<h3 id="materializations">Materializations<a class="headerlink" href="#materializations" title="Permanent link">&para;</a></h3>
<p>Materializations refer to the way dbt executes and persists the results of SQL queries. It is the Data Definition Language (DDL) and Data Manipulation Language (DML) used to create a model’s equivalent in a data warehouse.</p>
<p>Understanding the options for materializations will allow you to choose the best strategy based on factors like query performance, data freshness, and data volume. There are four materializations used in dbt: view, table, incremental, and ephemeral. We used <a href="https://docs.getdbt.com/best-practices/materializations/5-best-practices">dbt docs as our main source</a> for most of the materialization descriptions below.</p>
<h4 id="view">View<a class="headerlink" href="#view" title="Permanent link">&para;</a></h4>
<ul>
<li>Views return the freshest, real-time state of their input data when they’re queried, this makes them ideal as building blocks for larger models.</li>
<li>Views are also great for small datasets with minimally intensive logic that we want near real time access to.</li>
<li>Staging models are rarely accessed directly by our end users.</li>
<li>Staging models need to be always up-to-date and in sync with our source data as building blocks for later models so we’ll want to materialize our staging models as views.</li>
<li>Since views are the default materialization in dbt, we don’t have to do any specific configuration for this.</li>
<li>Still, for clarity, it’s a good idea to go ahead and specify the configuration to be explicit. We’ll want to make sure our dbt_project.yml looks like this:</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="nt">models</span><span class="p">:</span>
<span class="w">  </span><span class="nt">jaffle_shop</span><span class="p">:</span>
<span class="w">    </span><span class="nt">staging</span><span class="p">:</span>
<span class="w">      </span><span class="nt">+materialized</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">view</span>
</code></pre></div>
<h4 id="table">Table<a class="headerlink" href="#table" title="Permanent link">&para;</a></h4>
<ul>
<li>Tables are the most performant materialization, they return transformed data when queried with no need for reprocessing.</li>
<li>Tables are also ideal for frequently used, compute intensive transformations. Making a table allows us to <em>freeze</em> transformations in place.</li>
<li>Marts, like one that services a popular dashboard, are frequently accessed directly by our end users, and need to be performant.</li>
<li>Can often function with intermittently refreshed data, end user decision making in many domains is fine with hourly or daily data.</li>
<li>Given the above properties we’ve got a great use case for building the data itself into the warehouse, not the logic. In other words, a table.</li>
<li>The only decision we need to make with our marts is whether we can process the whole table at once or do we need to do it in chunks, that is, are we going to use the table materialization or incremental.</li>
</ul>
<h4 id="incremental">Incremental<a class="headerlink" href="#incremental" title="Permanent link">&para;</a></h4>
<ul>
<li>Incremental models build a table in pieces over time, only adding and updating new or changed rows.</li>
<li>Builds more quickly than a regular table of the same logic.</li>
<li>Initial runs are slow. Typically we use incremental models on very large datasets, so building the initial table on the full dataset is time consuming and equivalent to the table materialization.</li>
</ul>
<p>Sources: <a href="https://docs.getdbt.com/best-practices/materializations/4-incremental-models">Incremental models in-depth</a> and <a href="https://docs.getdbt.com/best-practices/materializations/2-available-materializations">Available materializations</a></p>
<h4 id="a-comparison-table">A comparison table<a class="headerlink" href="#a-comparison-table" title="Permanent link">&para;</a></h4>
<p><img alt="dbt materializations comparison table" src="../../images/dbt_materializations_comparison_table.png" /></p>
<p>Source: <a href="https://docs.getdbt.com/best-practices/materializations/2-available-materializations">Available materializations</a></p>
<h4 id="materializations-golden-rule">Materializations golden rule<a class="headerlink" href="#materializations-golden-rule" title="Permanent link">&para;</a></h4>
<ul>
<li>🔍 Start with a view. When the view gets too long to query for end users,</li>
<li>⚒️ Make it a table. When the table gets too long to build in your dbt Jobs,</li>
<li>📚 Build it incrementally. That is, layer the data in chunks as it comes in.</li>
</ul>
<h4 id="ephemeral">Ephemeral<a class="headerlink" href="#ephemeral" title="Permanent link">&para;</a></h4>
<p>Ephemeral models are not directly built into the database. Instead, dbt will interpolate the code from this model into dependent models as a CTE. Use the ephemeral materialization for:</p>
<ul>
<li>Light-weight transformations that are early on in your DAG</li>
<li>When they are only used in one or two downstream models, and</li>
<li>Do not need to be queried directly</li>
</ul>
<p>✅ Can help keep your data warehouse clean by reducing clutter<br/>
🚫 Overuse of ephemeral materialization can make queries harder to debug</p>
<p>Source: <a href="https://docs.getdbt.com/docs/build/materializations#ephemeral">Materializations</a></p>
<h3 id="where-to-configure-materializations">Where to configure materializations<a class="headerlink" href="#where-to-configure-materializations" title="Permanent link">&para;</a></h3>
<p>You can configure models in <code>dbt_project.yml</code>, the YAML file within the corresponding model’s folder, or within a specific model itself. Confusing thing about dbt configuration: the syntax and format change depend on where you use it!</p>
<div class="highlight"><pre><span></span><code><span class="c1"># in the dbt_project.yml file...</span>
<span class="nt">models</span><span class="p">:</span>
<span class="w">  </span><span class="nt">dse_analytics</span><span class="p">:</span>
<span class="w">    </span><span class="nt">staging</span><span class="p">:</span>
<span class="w">      </span><span class="nt">+materialized</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">view</span>
<span class="w">    </span><span class="nt">intermediate</span><span class="p">:</span>
<span class="w">      </span><span class="nt">+materialized</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">view</span>
<span class="w">    </span><span class="nt">marts</span><span class="p">:</span>
<span class="w">      </span><span class="nt">+materialized</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">table</span>

<span class="c1"># the YAML file within the corresponding model’s folder</span>
<span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>

<span class="nt">models</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">int_state_entities__active</span>
<span class="w">    </span><span class="nt">materialized</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">table</span>
<span class="w">    </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">This is a sample description.</span>
<span class="w">    </span><span class="nt">columns</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">name</span>
<span class="w">        </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Name of the entity</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1">-- within a specific model itself</span>
<span class="err">{{</span>
<span class="w">    </span><span class="n">config</span><span class="p">(</span>
<span class="w">        </span><span class="n">materialized</span><span class="o">=</span><span class="s1">&#39;view&#39;</span>
<span class="w">    </span><span class="p">)</span>
<span class="err">}}</span>

<span class="k">select</span><span class="w"> </span><span class="p">...</span>
</code></pre></div>
<h3 id="day-3-practice">Day 3: Practice<a class="headerlink" href="#day-3-practice" title="Permanent link">&para;</a></h3>
<p>Click either link for <a href="https://cagov.github.io/caldata-mdsa-training/data-transformation/dbt-cloud-practice/#day-3"><u>dbt Cloud</u></a> or <a href="https://cagov.github.io/caldata-mdsa-training/data-transformation/dbt-core-practice/#day-3"><u>dbt Core</u></a> practice.</p>
<h3 id="day-3-references">Day 3: References<a class="headerlink" href="#day-3-references" title="Permanent link">&para;</a></h3>
<h4 id="materializations-jinja-and-dbt-models">Materializations, Jinja, and dbt Models<a class="headerlink" href="#materializations-jinja-and-dbt-models" title="Permanent link">&para;</a></h4>
<ul>
<li><a href="https://cagov.github.io/data-infrastructure/dbt/dbt-performance/#2-model-level-materialization-matters">dbt materialization and performance considerations</a></li>
<li><a href="https://docs.getdbt.com/guides/using-jinja?step=1">Jinja tutorial: Use Jinja to improve your SQL code</a></li>
<li><a href="https://cagov.github.io/caldata-mdsa-training/data-transformation/dbt-cloud/#models-in-dbt">Re-watch the second and third video from Day 1: Models in dbt</a></li>
</ul>
<h2 id="day-4">Day 4<a class="headerlink" href="#day-4" title="Permanent link">&para;</a></h2>
<h3 id="dbt-docs">dbt Docs<a class="headerlink" href="#dbt-docs" title="Permanent link">&para;</a></h3>
<p>A key feature of dbt is the automated generation of documentation and lineage from your project.
The framework reads your SQL models and YAML configuration files and produces a static HTML document from them.
This documentation can then be hosted in a number of places, including dbt Cloud, GitHub Pages, or Azure Static Web Apps.
Depending on platforms we are using for the project, we will demonstrate dbt docs using one of the following:</p>
<ol>
<li>Hosted in dbt Cloud. This can be useful if you are writing docs in a branch and want to visualize how they are rendered.</li>
<li>If we are using GitHub, we’ll demonstrate how the docs can be built from the repository and hosted on GitHub Pages.</li>
<li>If we are using Azure DevOps, we’ll demonstrate how the docs can be built from the repository and hosted using Azure Static Web Apps.</li>
<li>If we are using Bitbucket and are okay with public-facing docs, we'll demonstrate how the docs can be built and hosted using Bitbucket Cloud.</li>
<li>If we are using none of the above, we'll show you how to generate and view the docs locally.</li>
</ol>
<h3 id="data-environments-and-jobs">Data environments and jobs<a class="headerlink" href="#data-environments-and-jobs" title="Permanent link">&para;</a></h3>
<h4 id="environments-in-snowflake">Environments in Snowflake<a class="headerlink" href="#environments-in-snowflake" title="Permanent link">&para;</a></h4>
<p>We often talk about the concept of "environments".
Broadly speaking, environments are a collection of compute resources, software, and configuration,
which together represent a functioning context for development.
Examples of environments include:</p>
<ol>
<li>A “production” environment which is used to run the dbt models that have been merged to <code>main</code>. This can be run on an ad-hoc basis, or can be run on a schedule to ensure that models are never more than some amount of time old.</li>
<li>A "development" environment, which is used to run tests on branches and pull requests, and can help to catch bugs and regressions before they are deployed to production.</li>
<li>A "user acceptance testing (UAT)" environment, which can be used as a final testing environment for verifying code before it is deployed to production.</li>
</ol>
<p>Unfortunately, that's pretty vague, since there are lots of different ways environments can be set up!
Depending on your situation, different environments in Snowflake could be represented by:</p>
<ul>
<li>entirely different accounts</li>
<li>different databases within the same account, or even</li>
<li>different schemas within the same database.</li>
</ul>
<p>In our default MDSA architecture we usually have two environments, "dev" and "prod", which reside in the same Snowflake account.
Each of these environments consists of a set of databases corresponding to our layered data architecture
(see our <a href="../../cloud-data-warehouses/snowflake/#snowflake-architecture">Snowflake training</a> for more detail).</p>
<h4 id="environments-in-dbt-cloud">Environments in dbt Cloud<a class="headerlink" href="#environments-in-dbt-cloud" title="Permanent link">&para;</a></h4>
<p>dbt Cloud also has a concept of an Environment,
which is a virtual machine in dbt Cloud that has all of the relevant software dependencies and environment variables set.
Roughly speaking, an environment in dbt Cloud will correspond to one of your environments in Snowflake.</p>
<p>You’ve already encountered one environment, which is your “Develop:  Cloud IDE”.
But you can create other environments in dbt Cloud for various purposes.
Our typical dbt Cloud setup includes the following environments:</p>
<ul>
<li>Development, which uses the "dev" Snowflake environment. This is what you use when you work in the cloud IDE.</li>
<li>Production, which uses the "prod" Snowflake environment. This is what we use to build production data models.</li>
<li>Continuous Integration, which uses the "dev" Snowflake environment. This is what runs the automated CI checks.</li>
</ul>
<h4 id="jobs">Jobs<a class="headerlink" href="#jobs" title="Permanent link">&para;</a></h4>
<p>A "job" is a command or series of commands that run in a given environment.
Examples of jobs we often use in our MDSA projects include:</p>
<ul>
<li>Running a nightly build of data models</li>
<li>Running continuous integration (CI, see below!) checks</li>
<li>Building project docs</li>
</ul>
<p>Jobs can be configured in a number of ways: they can have different environment variables set,
they can run on a schedule, or they can be triggered by a specific action like a pull request being opened,
or a branch being merged.</p>
<h3 id="continuous-integration-and-continuous-deployment-cicd">Continuous integration and continuous deployment (CI/CD)<a class="headerlink" href="#continuous-integration-and-continuous-deployment-cicd" title="Permanent link">&para;</a></h3>
<h4 id="what-continuous-integration-ci-is-and-why-you-shouldnt-ignore-it">What Continuous Integration (CI) is, and why you shouldn’t ignore it<a class="headerlink" href="#what-continuous-integration-ci-is-and-why-you-shouldnt-ignore-it" title="Permanent link">&para;</a></h4>
<p>Continuous Integration checks in GitHub, Azure DevOps, or BitBucket are automated tests that are run against your code every time you push a change.
They are an important part of the software development process, and can help you:</p>
<ul>
<li><strong>Catch errors and issues early:</strong> CI checks can identify issues with your code before they can cause problems in production.</li>
<li><strong>Improve code quality:</strong> CI checks can help you to improve the quality of your code by identifying issues like duplicate or dead code and potential security vulnerabilities.</li>
<li><strong>Establish a house style:</strong> CI checks can enforce various code formatting rules and conventions that your team has agreed upon.</li>
</ul>
<p>We have set up your project repository so that PRs cannot be merged to <code>main</code> unless these checks pass.
This can sometimes feel annoying! At the end of the day, however, CI/CD checks shouldn’t feel too painful or like a box-checking exercise:
they are rather intended to be a routine and helpful part of the development process.
Ultimately, experience has shown that effective use of CI/CD greatly speeds up development.</p>
<h4 id="continuous-deployment-cd">Continuous Deployment (CD)<a class="headerlink" href="#continuous-deployment-cd" title="Permanent link">&para;</a></h4>
<p>Continuous Deployment (CD) in most MDSA projects is usually pretty simple.
We typically do not build any applications or deploy cloud resources.
Instead, whatever is in the <code>main</code> branch is considered "production",
and our dbt projects and docs are built using that.</p>
<p>For a deeper dive into how CI/CD is configured for this project see <a href="../../code/ci-cd/">these docs</a></p>
<h4 id="demo-cicd-in-a-development-workflow">Demo: CI/CD in a development workflow<a class="headerlink" href="#demo-cicd-in-a-development-workflow" title="Permanent link">&para;</a></h4>
<ol>
<li>How to read the results of CI checks on a PR.</li>
<li>How merging to <code>main</code> results in production dbt builds.</li>
</ol>
<h3 id="custom-schema-names">Custom schema names<a class="headerlink" href="#custom-schema-names" title="Permanent link">&para;</a></h3>
<ol>
<li>We’ll talk about how the database schemas in which dbt models are built are determined. In development, the models get built in a different place (e.g., your <code>DBT_&lt;first-name-initial+last-name&gt;</code>schema) than they do in production.</li>
<li>We’ll discuss how this project is configured to use a custom schema name generated using <code>transform/macros/get_custom_schema.sql</code>.</li>
</ol>
<h3 id="day-4-practice">Day 4: Practice<a class="headerlink" href="#day-4-practice" title="Permanent link">&para;</a></h3>
<p>Click either link for <a href="https://cagov.github.io/caldata-mdsa-training/data-transformation/dbt-cloud-practice/#day-4"><u>dbt Cloud</u></a> or <a href="https://cagov.github.io/caldata-mdsa-training/data-transformation/dbt-core-practice/#day-4"><u>dbt Core</u></a> practice.</p>
<h3 id="day-4-references">Day 4: References<a class="headerlink" href="#day-4-references" title="Permanent link">&para;</a></h3>
<h4 id="documentation">Documentation<a class="headerlink" href="#documentation" title="Permanent link">&para;</a></h4>
<ul>
<li><a href="https://platform.thinkific.com/videoproxy/v1/play/c71iuqg40bhpn3t11p80">What is documentation?</a></li>
<li><a href="https://platform.thinkific.com/videoproxy/v1/play/ce2dchnf17fhkgqdq59g">Writing documentation and doc blocks</a></li>
<li><a href="https://docs.snowflake.com/en/user-guide/key-pair-auth#configuring-key-pair-authentication">Creating encrypted key-pairs for service accounts that run CI and Production jobs</a></li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.copy"], "search": "../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.56ea9cef.min.js"></script>
      
    
  </body>
</html>